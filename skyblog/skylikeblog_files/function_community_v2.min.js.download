
$(document).ready(function(){$.topic.reply();$.topic.paging();$.topic.pagingDropdown();$.social.sharing();$(document).foundation();$(document).on('click','.spoil-btn',function(){$(this).html('[Spoil] คลิกเพื่อดูข้อความที่ซ่อนไว้').toggleClass('spoil_hide').next().toggle();$('.spoil_hide').html('[Spoil] คลิกเพื่อซ่อนข้อความ');});var to_link=window.location.href;to_link=to_link.match(/^(.+)\/(comment[0-9]+(-[0-9]+)?)(.*)$/);if(to_link!==null&&to_link[3]!==undefined)
{to_link[3]=to_link[3].replace('-','');var cur_comment=to_link[2].split('-');if(to_link[3]<=5)
{var cid=$('#'+cur_comment[0]).attr('data').replace('comment-','');var that=$('.loadmore-bar-reply.firsted#more-'+cid);that.html('<span class="loading-txt">กำลังโหลดข้อมูล...</span>');if($('.comment-'+cid+'-ref').length)
{$('.comment-'+cid+'-ref').show();that.remove();$('#more-'+cid).show();jumpTo($('#'+to_link[2]));}
else
{return;}}
else
{var limit_reply=5;var range=Math.ceil((to_link[3]/limit_reply)-1);var cid=$('#'+cur_comment[0]).attr('data').replace('comment-','');var that=$('.loadmore-bar-reply#more-'+cid);that.html('<span class="loading-txt">กำลังโหลดข้อมูล...</span>');$('.m-reply-comment').remove();var next_m_reply=that.next('.m-reply');var topic_id=$('.topic-title').attr('id').replace('topic-','');var author=$('.topic-member').attr('data').replace('topic-member-','');$.ajax({type:"POST",cache:false,url:"/topic/nextReply",data:{'cid':cid,'range':range,'topic_id':topic_id,'author':author},dataType:'html',success:function(rs)
{that.remove();next_m_reply.html(rs);jumpTo($('#'+to_link[2]));$(".display-post-edit-hide").hide();}});}}
else if(to_link!==null&&to_link[2]!==undefined)
{jumpTo($('#'+to_link[2]));}
var lastScrollTop=0;$('.btn-scroll-top').on('click',function(){$('.btn-scroll-top').hide();$('html,body').animate({scrollTop:0},700);});$(document).scroll(function(){var st=$(this).scrollTop();if(st<lastScrollTop&&st!==0){$('.btn-scroll-top').show();}else if(st>lastScrollTop||st===0){$('.btn-scroll-top').hide();}
lastScrollTop=st;var end=parseInt($('#end').val());var nextPage=parseInt($('#page').val())+1;if($(window).scrollTop()+window.innerHeight>=$(document).height()-2&&nextPage<end)
{loadData();}});});function jumpTo(id)
{$('html,body').delay(3000).queue(function(){var topOffset=0;if($(id).length>0){topOffset=$(id).offset().top;}
var targetOffset=topOffset-40;$(this).animate({scrollTop:targetOffset},700).dequeue();})}
(function($){$.topic={};$.social={};$('.btn-scroll-top').hide();$.topic.reply=function()
{$(document).on('click','.loadmore-bar-reply.firsted',function(){var that=$(this);that.html('<span class="loading-txt">กำลังโหลดข้อมูล...</span>');var cid=$(this).attr('id').replace('more-','');if($('.comment-'+cid+'-ref').length)
{$('.comment-'+cid+'-ref').show();that.remove();$('#more-'+cid).show();}
else
{return;}});$(document).on('click','.loadmore-bar-reply.nexted',function(){var that=$(this);that.html('<span class="loading-txt">กำลังโหลดข้อมูล...</span>');var next_m_reply=that.next('.m-reply');var cid=$(this).attr('id').replace('more-','');var range=$(this).attr('range');var topic_id=$('.topic-title').attr('id').replace('topic-','');var author=$('.topic-member').attr('data').replace('topic-member-','');var ajaxload=false;if(ajaxload==false)
{$.ajax({type:"POST",cache:false,url:"/topic/nextReply",data:{'cid':cid,'range':range,'topic_id':topic_id,'author':author},dataType:'html',success:function(rs)
{ajaxload=true;that.remove();next_m_reply.html(rs);$(".display-post-edit-hide").hide();}});}});}
$.topic.pagingDropdown=function()
{$(document).on('change','.dropdown-jump-paging',function(){var page=$(this).val();var that=$(this).parent('td.wrap-select');that.html('<span class="loading-txt">กำลังโหลดข้อมูล...</span>');var topic_id=$('.topic-title').attr('id').replace('topic-','');var author=$('.topic-member').attr('data').replace('topic-member-','');var total=$('.total-comments-counts').data('total');var ajaxload=false;if(ajaxload==false)
{$.ajax({type:"POST",cache:false,url:"/topic/nextComment",data:{'topic_id':topic_id,'page':page,'author':author,'total':total},dataType:'html',success:function(rs)
{ajaxload=true;$('div.wrap-m-pagination').remove();$('.m-comment-page').html(rs);var lastpage=$('.wrap-m-pagination').data('total');$('.total-comments-counts').data('total',lastpage);$('#comments_postall_number').html(lastpage);$(".display-post-edit-hide").hide();var targetOffset=$('#comments-counts').offset().top-40;$('body,html').animate({scrollTop:targetOffset},700);}});}});}
$.topic.paging=function()
{$(document).on('click','.bar-paging',function(){var that=$('td.wrap-select');that.html('<span class="loading-txt">กำลังโหลดข้อมูล...</span>');var topic_id=$('.topic-title').attr('id').replace('topic-','');var page=$(this).attr('data').replace('page-','');var author=$('.topic-member').attr('data').replace('topic-member-','');var total=$('.total-comments-counts').data('total');var ajaxload=false;if(ajaxload==false)
{$.ajax({type:"POST",cache:false,url:"/topic/nextComment",data:{'topic_id':topic_id,'page':page,'author':author,'total':total},dataType:'html',success:function(rs)
{ajaxload=true;$('div.wrap-m-pagination').remove();$('.m-comment-page').html(rs);var lastpage=$('.wrap-m-pagination').data('total');$('.total-comments-counts').data('total',lastpage);$('#comments_postall_number').html(lastpage);$(".display-post-edit-hide").hide();var targetOffset=$('#comments-counts').offset().top-40;$('body,html').animate({scrollTop:targetOffset},700);}});}});}
$.social.sharing=function()
{$(".m-press-to-comment").click(function(){$(".m-block-sticky-sharing").toggle();});}})(jQuery);
$(document).ready(function(){$('#ptSidebar').removeClass('pt-wrapper-sidenav-show');if($('.total-noti').length>0){var url="/notification/notiCnt?time="+Math.random();$.ajax({type:'POST',url:url,dataType:'json',success:function(rs){if(rs.cnt!=0){if(rs.cnt>99){rs.cnt='99+';}
$('.total-noti').html('<b class="pt-nav__badge">'+rs.cnt+'</b>');$('.total-noti-sidenav').html('<i class="pt-lists-item__meta-badgenumber m-t-de4">'+rs.cnt+'</i>');}else{$('.total-noti').html('');$('.total-noti-sidenav').html('');}}});}
if($('.total-notipm').length>0){var url="/notification/notiCntPm?time="+Math.random();$.ajax({type:'POST',url:url,dataType:'json',success:function(rs){if(rs.cnt!=0){if(rs.cnt>99){rs.cnt='99+';}
$('.total-notipm').html('<i class="pt-lists-item__meta-badgenumber m-t-de4">'+rs.cnt+'</i>');}else{$('.total-notipm').html('');}}});}});function ptToggleSidebar(){if($('#ptModalwithNav').hasClass('pt-modal-mask')){$('body').removeClass('hide-scroll-modal');$('#ptModalwithNav').removeClass('pt-modal-mask')
$('#ptSidebar').removeClass('pt-wrapper-sidenav-show');}
else{$('body').addClass('hide-scroll-modal');$('#ptModalwithNav').addClass('pt-modal-mask')
$('#ptSidebar').addClass('pt-wrapper-sidenav-show');}}
function ptToggleSubmenu(){var attNameArrow='keyboard_arrow_down';if($('#ptListSubmenu').hasClass('pt-list-submenu-show')){$('#ptListSubmenu').removeClass('pt-list-submenu-show');attNameArrow='keyboard_arrow_up';document.getElementById("item-arrow-updown").innerHTML=attNameArrow;}
else{$('#ptListSubmenu').addClass('pt-list-submenu-show');attNameArrow='keyboard_arrow_down';document.getElementById("item-arrow-updown").innerHTML=attNameArrow;}}